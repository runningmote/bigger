<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>放大镜效果</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            list-style: none;
        }
        
        .title {
            position: relative;
            width: 400px;
            height: 400px;
            border: 1px solid black;
            margin: 50px auto;
        }
        
        p #miediumImg {
            width: 400px;
            height: 400px;
        }
        
        h1 {
            position: absolute;
            top: 405px;
            width: 400px;
            height: 55px;
        }
        
        h1 span {
            border-radius: 5px;
        }
        
        h1 .backword {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 20px;
            height: 50px;
            background-image: url(images/5.jpg);
            background-repeat: no-repeat;
            background-position: -23px -13px;
            background-size: 65px 80px;
        }
        
        h1 .forword {
            display: block;
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 50px;
            background-image: url(images/4.jpg);
            background-repeat: no-repeat;
            background-position: -23px -13px;
            background-size: 65px 80px;
        }
        
        h1 .backword_disbled {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 20px;
            height: 50px;
            background-image: url(images/5.jpg);
            background-repeat: no-repeat;
            background-position: -23px -13px;
            background-size: 65px 80px;
        }
        
        h1 .forword_disbled {
            display: block;
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 50px;
            background-image: url(images/4.jpg);
            background-repeat: no-repeat;
            background-position: -23px -13px;
            background-size: 65px 80px;
        }
        
        .box {
            width: 360px;
            height: 55px;
            position: absolute;
            top: 0;
            left: 20px;
            overflow: hidden;
        }
        
        ul {
            position: absolute;
            top: 0;
            left: 2px;
            width: 576px;
            height: 55px;
        }
        
        li {
            width: 72px;
            height: 55px;
            float: left;
        }
        
        #icount li>img {
            display: block;
            float: left;
            position: relative;
            top: 0;
            left: 15%;
            width: 50px;
            height: 50px;
            border: 1px solid black;
        }
        
        p span {
            display: block;
        }
        
        .floor {
            position: absolute;
            top: 0;
            left: 0;
            width: 200px;
            height: 200px;
            background: orange;
            opacity: 0.6;
            display: none;
        }
        
        .mobile {
            width: 400px;
            height: 400px;
            position: absolute;
            top: 0;
            left: 0;
        }
        
        .bigImg {
            position: absolute;
            top: 0;
            left: 401px;
            width: 400px;
            height: 400px;
            overflow: hidden;
            border: 1px solid #ccc;
        }
        
        .bigImg img {
            position: absolute;
            width: 800px;
            height: 800px;
            display: none;
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <div class="title">
        <p id="dis">
            <img id="miediumImg" src="images/1.jpg" alt="">
            <span class="floor" style></span>
            <span class="mobile"></span>
            <span class="bigImg" style="display: none;">
				<img  alt="" class="loadImg">
			</span>
        </p>
        <h1>
            <span class="backword"></span>
            <span class="forword"></span>
            <div class="box">
                <ul id="icount">
                    <li><img src="images/1.jpg" alt=""></li>
                    <li><img src="images/2.jpg" alt=""></li>
                    <li><img src="images/3.jpg" alt=""></li>
                    <li><img src="images/2.jpg" alt=""></li>
                    <li><img src="images/3.jpg" alt=""></li>
                    <li><img src="images/1.jpg" alt=""></li>
                    <li><img src="images/3.jpg" alt=""></li>
                    <li><img src="images/2.jpg" alt=""></li>
                </ul>
            </div>
        </h1>
    </div>
    <script type="text/javascript" src="../jQuery库/jquery-1.12.4.js"></script>
    <script type="text/javascript">
        $(function() {
            moveMiniImg()
            hoveMiniImg()
            bigImage()

            function bigImage() {
                var $dis = $('#dis')
                var $miediumImg = $('#miediumImg')
                var $floor = $('.floor')
                var $mobile = $('.mobile')
                var $bigImg = $('.bigImg')
                var $loadImg = $('.loadImg')
                var floorWidth = $floor.width()
                var floorHeight = $floor.height()
                var mobileWidth = $mobile.width()
                var mobileHeight = $mobile.height()
                $mobile.hover(function() {
                    $floor.show()
                    $bigImg.show()
                    var src = $miediumImg.attr('src').replace('.jpg', '-l.jpg')
                    $loadImg.attr('src', src)
                    $loadImg.on('load', function() {
                        var loadWidth = $loadImg.width()
                        var loadHeight = $loadImg.height()
                        $bigImg.css({
                            width: loadWidth / 2,
                            height: loadHeight / 2
                        })
                        $loadImg.show()
                        $mobile.mousemove(function(event) {
                            var left = 0
                            var top = 0
                            var eventLeft = event.offsetX
                            var eventTop = event.offsetY
                            left = eventLeft - floorWidth / 2
                            top = eventTop - floorHeight / 2
                            if (left < 0) {
                                left = 0
                            } else if (left > mobileWidth - floorWidth) {
                                left = mobileWidth - floorWidth
                            }
                            if (top < 0) {
                                top = 0
                            } else if (top > mobileWidth - floorWidth) {
                                top = mobileWidth - floorWidth
                            }
                            $floor.css({
                                left: left,
                                top: top
                            })

                            left = -left * loadWidth / mobileWidth
                            top = -top * loadHeight / mobileHeight
                            $loadImg.css({
                                left: left,
                                top: top

                            })
                        })

                    })
                }, function() {
                    $floor.hide()
                    $bigImg.hide()
                    $loadImg.hide()
                })
            }

            function hoveMiniImg() {
                $('#icount>li').hover(function() {
                    // this.children().className = 'hoveredThumb'
                    var imgs = $('#icount>li').children()
                    $(this).children().css('border', '2px solid red')
                    var $img = $(this).children()
                    $img.addClass('hoveredThumb');
                    var src = $(this).children().first().attr("src");
                    $('#miediumImg').attr('src', src);
                }, function() {
                    $(this).children().removeClass('hoveredThumb')

                    $(this).children().css('border', '')
                })
            }

            function moveMiniImg() {
                var $as = $('.title>h1>span')
                var $backword = $as.first()
                var $forword = $as.last()
                var $Ul = $('#icount')
                var SHOW_COUNT = 5
                var imgCount = $Ul.children('li').length
                var moveCount = 0
                var liWidth = $Ul.children('li').width()
                if (imgCount > SHOW_COUNT) {
                    $forword.attr('class', 'forword')
                }
                $forword.click(function() {
                    if (moveCount === imgCount - SHOW_COUNT) {
                        return
                    }
                    moveCount++
                    $backword.attr('class', 'backword')
                    if (moveCount === imgCount - SHOW_COUNT) {
                        $forword.attr('class', 'forword_disbled')
                    }
                    $Ul.css({
                        left: -moveCount * liWidth
                    })
                })
                $backword.click(function() {
                    if (moveCount === 0) {
                        return
                    }
                    moveCount--
                    $forword.attr('class', 'forword')
                    if (moveCount === 0) {
                        $backword.attr('class', 'backword_disbled')
                    }
                    $Ul.css({
                        left: -moveCount * liWidth
                    })
                })
            }
        })
    </script>
</body>

</html>